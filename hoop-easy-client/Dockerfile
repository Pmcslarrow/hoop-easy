FROM node:18-alpine AS Production

ARG REACT_APP_APIKEY
ARG REACT_APP_APPID
ARG REACT_APP_DOMAIN
ARG REACT_APP_MEASUREMENT
ARG REACT_APP_MSI
ARG REACT_APP_PROJECTID
ARG REACT_APP_STORAGE

ENV NODE_ENV=production
ENV REACT_APP_APIKEY=$REACT_APP_APIKEY
ENV REACT_APP_APPID=$REACT_APP_APPID
ENV REACT_APP_DOMAIN=$REACT_APP_DOMAIN
ENV REACT_APP_MEASUREMENT=$REACT_APP_MEASUREMENT
ENV REACT_APP_MSI=$REACT_APP_MSI
ENV REACT_APP_PROJECTID=$REACT_APP_PROJECTID
ENV REACT_APP_STORAGE=$REACT_APP_STORAGE

WORKDIR /app/src/hoop-easy-client

COPY package*.json ./

RUN npm install

COPY . .

RUN npm run build

CMD ["npx", "serve", "-s", "build"]
